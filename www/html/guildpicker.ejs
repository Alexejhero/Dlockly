<% include partials/head %>

<body>
  <h1>Logged in as "<%= user.user.tag%>"</h1>
  <a href='logout'><button>Log out</button></a><br>
    <p>
      <input type="checkbox" id="check" onclick="changeTheme()">Dark Theme
  </p>
  <% if ((configurableGuilds && configurableGuilds[0]) || (adminGuilds && adminGuilds[0])) { %>

    <% if (configurableGuilds && configurableGuilds[0]) { %>

      <h2>Pick a server to edit it's configuration</h2><ul>

      <% for (var guild of configurableGuilds) { %>

        <li><a href='/?guild=<%= guild.id %>'><%= guild.name %></a><a style="font-size:13px"> (<%= guild.id %>)</a></li>
        
      <% } %>

      </ul>

    <% } %>

    <% if (adminGuilds && adminGuilds[0]) { %>

      <br><h2>Guilds you have access to because you're an admin</h2><ul>

      <% for (var guild of adminGuilds) { %>

        <li><a <% if (guild.hasEmptyConfig) { %>class="gray"<% } %> href='/?guild=<%= guild.id %>'><%= guild.name %></a><a <% if (guild.hasEmptyConfig) { %>class="gray"<% } %> style="font-size:13px"> (<%= guild.id %>)</a></li>
        
      <% } %>

      </ul>
      
    <% } %>

  <% } else { %>

    <h2>You have no servers available<h2>
    <p>You can invite the bot <a href='https://discordapp.com/oauth2/authorize?client_id=591694201230721043&scope=bot&permissions=8'>here</a></p>

  <% } %>
        <script>
    function getCookie(cname) {
  var name = cname + "=";
  var decodedCookie = decodeURIComponent(document.cookie);
  var ca = decodedCookie.split(';');
  for(var i = 0; i <ca.length; i++) {
    var c = ca[i];
    while (c.charAt(0) == ' ') {
      c = c.substring(1);
    }
    if (c.indexOf(name) == 0) {
      return c.substring(name.length, c.length);
    }
  }
  return "";
}
    let check = document.getElementById('check')
    if(getCookie('theme') == 'night') check.checked = true
    
    function changeTheme() {
    isDark = check.checked
      if(isDark) {
        document.getElementById('color').disabled = false
                 document.cookie = `theme=night; expires=${new Date(Date.now() +1000 * 60 * 60 * 24 * 365)}`;
      }
      else {
        document.getElementById('color').disabled = true
           document.cookie = `theme=; expires=${new Date(Date.now() +1000 * 60 * 60 * 24 * 365)}`;
      }
    }
  </script>
</body>
